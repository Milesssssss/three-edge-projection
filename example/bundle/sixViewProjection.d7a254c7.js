let e,t,r,o,n,i,s,a;var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},d={},c={},u=l.parcelRequire6c98;null==u&&((u=function(e){if(e in d)return d[e].exports;if(e in c){var t=c[e];delete c[e];var r={id:e,exports:{}};return d[e]=r,t.call(r.exports,r,r.exports),r.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){c[e]=t},l.parcelRequire6c98=u);var h=u("ilwiq"),f=u("jiuw3"),w=u("5Rd1x"),p=u("7lx9d"),h=u("ilwiq");const g=new WeakMap;class y extends h.Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,o){let n=new h.FileLoader(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,e=>{this.parse(e,t,o)},r,o)}parse(e,t,r){this.decodeDracoFile(e,t,null,null,h.SRGBColorSpace).catch(r)}decodeDracoFile(e,t,r,o,n=h.LinearSRGBColorSpace){let i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!r,vertexColorSpace:n};return this.decodeGeometry(e,i).then(t)}decodeGeometry(e,t){let r;let o=JSON.stringify(t);if(g.has(e)){let t=g.get(e);if(t.key===o)return t.promise;if(0===e.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n=this.workerNextTaskID++,i=e.byteLength,s=this._getWorker(n,i).then(o=>(r=o,new Promise((o,i)=>{r._callbacks[n]={resolve:o,reject:i},r.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return s.catch(()=>!0).then(()=>{r&&n&&this._releaseTask(r,n)}),g.set(e,{key:o,promise:s}),s}_createGeometry(e){let t=new h.BufferGeometry;e.index&&t.setIndex(new h.BufferAttribute(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let o=e.attributes[r],n=o.name,i=o.array,s=o.itemSize,a=new h.BufferAttribute(i,s);"color"===n&&(this._assignVertexColorSpace(a,o.vertexColorSpace),a.normalized=i instanceof Float32Array==!1),t.setAttribute(n,a)}return t}_assignVertexColorSpace(e,t){if(t!==h.SRGBColorSpace)return;let r=new h.Color;for(let t=0,o=e.count;t<o;t++)r.fromBufferAttribute(e,t).convertSRGBToLinear(),e.setXYZ(t,r.r,r.g,r.b)}_loadLibrary(e,t){let r=new h.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((t,o)=>{r.load(e,t,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let o=m.toString(),n=["/* draco decoder */",r,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function m(){let e,t;onmessage=function(r){let o=r.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let n=o.buffer,i=o.taskConfig;t.then(e=>{let t=e.draco,r=new t.Decoder;try{let e=function(e,t,r,o){let n,i;let s=o.attributeIDs,a=o.attributeTypes,l=t.GetEncodedGeometryType(r);if(l===e.TRIANGULAR_MESH)n=new e.Mesh,i=t.DecodeArrayToMesh(r,r.byteLength,n);else if(l===e.POINT_CLOUD)n=new e.PointCloud,i=t.DecodeArrayToPointCloud(r,r.byteLength,n);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!i.ok()||0===n.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+i.error_msg());let d={index:null,attributes:[]};for(let r in s){let i,l;let c=self[a[r]];if(o.useUniqueIDs)l=s[r],i=t.GetAttributeByUniqueId(n,l);else{if(-1===(l=t.GetAttributeId(n,e[s[r]])))continue;i=t.GetAttribute(n,l)}let u=function(e,t,r,o,n,i){let s=i.num_components(),a=r.num_points(),l=a*s,d=l*n.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,n),u=e._malloc(d);t.GetAttributeDataArrayForAllPoints(r,i,c,d,u);let h=new n(e.HEAPF32.buffer,u,l).slice();return e._free(u),{name:o,array:h,itemSize:s}}(e,t,n,r,c,i);"color"===r&&(u.vertexColorSpace=o.vertexColorSpace),d.attributes.push(u)}return l===e.TRIANGULAR_MESH&&(d.index=function(e,t,r){let o=r.num_faces(),n=3*o,i=4*n,s=e._malloc(i);t.GetTrianglesUInt32Array(r,i,s);let a=new Uint32Array(e.HEAPF32.buffer,s,n).slice();return e._free(s),{array:a,itemSize:1}}(e,t,n)),e.destroy(n),d}(t,r,new Int8Array(n),i),s=e.attributes.map(e=>e.array.buffer);e.index&&s.push(e.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:e},s)}catch(e){console.error(e),self.postMessage({type:"error",id:o.id,error:e.message})}finally{t.destroy(r)}})}}}var b=u("kp7Te"),k=u("4CEV9");(0,h.Object3D).DEFAULT_UP.set(0,0,1);const _={displayModel:!0,displayProjections:!0,includeIntersectionEdges:!1,useWorker:!1,angleThreshold:10,regenerate:()=>{T=C()}};let T=null;const L={top:null,bottom:null,front:null,back:null,left:null,right:null},A={top:new h.Vector3(0,0,3),bottom:new h.Vector3(0,0,-3),front:new h.Vector3(0,3,0),back:new h.Vector3(0,-3,0),left:new h.Vector3(-3,0,0),right:new h.Vector3(3,0,0)};function*C(){let e=window.performance.now();if(a.angleThreshold=_.angleThreshold,a.includeIntersectionEdges=_.includeIntersectionEdges,_.useWorker){s.innerText="Processing with workers...";try{let e=yield a.generateWithWorkers(n,{onProgress:(e,t,r)=>{s.innerText=`Processing with workers...
Current: ${t} view - ${parseFloat((100*r).toFixed(1))}%
Overall: ${parseFloat((100*e).toFixed(1))}%`}});for(let[t,r]of Object.entries(e))L[t].geometry.dispose(),L[t].geometry=r}catch(e){s.innerText=`Error: ${e.message}`,console.error(e)}}else{let e=a.generate(n,{onProgress:(e,t,r)=>{s.innerText=`Processing: ${t} view - ${parseFloat((100*r).toFixed(1))}%
Overall: ${parseFloat((100*e).toFixed(1))}%`}}),t=e.next();for(;!t.done;)t=e.next(),yield;let r=t.value;for(let[e,t]of Object.entries(r))L[e].geometry.dispose(),L[e].geometry=t}let t=window.performance.now()-e;s.innerText=`Complete!
Total time: ${t.toFixed(2)}ms
Average per view: ${(t/6).toFixed(2)}ms
Mode: ${_.useWorker?"Parallel (Workers)":"Sequential"}`}!async function(){s=document.getElementById("output"),(e=new h.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),e.setClearColor(15658734,1),document.body.appendChild(e.domElement),r=new h.Scene;let l=new h.DirectionalLight(16777215,3.5);l.position.set(1,2,3),r.add(l);let d=new h.AmbientLight(11583173,.5);r.add(d),i=new h.Group,r.add(i);let c=new p.GLTFLoader;c.setMeshoptDecoder(b.MeshoptDecoder);let u=new y;u.setDecoderPath("https://www.gstatic.com/draco/v1/decoders/"),c.setDRACOLoader(u);let g=await c.loadAsync("http://127.0.0.1:8080/SFL-CPD20-Y.glb");n=g.scene;let m=new h.MeshStandardMaterial({polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,opacity:.5,transparent:!0});n.traverse(e=>{e.material&&(e.material=m)}),i.updateMatrixWorld(!0);let P=new h.Box3;for(let[e,t]of(P.setFromObject(n,!0),P.getCenter(i.position),i.position.multiplyScalar(-1),i.add(n),Object.entries(A))){let o=new h.LineSegments(new h.BufferGeometry,new h.LineBasicMaterial({color:{top:16711680,bottom:8388608,front:65280,back:32768,left:255,right:128}[e]||0,linewidth:2}));o.position.copy(t),r.add(o),L[e]=o}a=new k.MultiViewProjectionGenerator,(t=new h.PerspectiveCamera(39.5,window.innerWidth/window.innerHeight,.01,500)).position.set(10,10,10),t.updateProjectionMatrix(),t.lookAt(0,0,0),new w.OrbitControls(t,e.domElement),(o=new f.GUI).add(_,"displayModel"),o.add(_,"displayProjections"),o.add(_,"includeIntersectionEdges").onChange(()=>_.regenerate()),o.add(_,"angleThreshold",1,90,1).onChange(()=>_.regenerate()),o.add(_,"useWorker"),o.add(_,"regenerate");let x=o.addFolder("Views");for(let e of Object.keys(L))_[`show_${e}`]=!0,x.add(_,`show_${e}`).name(e);x.open(),T=C(),function o(){if(requestAnimationFrame(o),T){let e=T.next();e.done&&(T=null)}for(let[e,t]of(n.visible=_.displayModel,Object.entries(L)))t.visible=_.displayProjections&&_[`show_${e}`];e.render(r,t)}(),window.addEventListener("resize",function(){t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)},!1)}();
//# sourceMappingURL=sixViewProjection.d7a254c7.js.map
